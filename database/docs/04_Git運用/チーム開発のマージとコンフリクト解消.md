# チーム開発のマージ手順とコンフリクト解消ガイド

このドキュメントは、チーム全員が安全かつ効率的に`feature`ブランチを`develop`ブランチにマージするための手順と、コンフリクト（競合）が発生した際の具体的な解消方法を定めます。

---

## 1. 開発の鉄則：マージ前の「お作法」

**Pull Requestを出す直前、あるいはマージする直前には、必ず最新の`develop`ブランチの変更を自分の`feature`ブランチに取り込みます。**

これを「**ブランチの更新**」と呼びます。この一手間が、`develop`ブランチを常に正常に保ち、チーム全体の混乱を防ぎます。

---

## 2. 安全なマージまでの流れ (Pull Request方式)

1.  **`feature`ブランチでの作業を完了させる**
    - 自分の担当機能の実装や修正が終わったら、すべての変更をコミットし、リモートリポジトリにプッシュします。
    ```bash
    # feature/my-task ブランチで作業
    git add .
    git commit -m "feat: 〇〇機能を実装"
    git push origin feature/my-task
    ```

2.  **【最重要】`develop`ブランチの変更を取り込む**
    - GitHubでPull Requestを作成する**前**に、ローカルで`develop`ブランチの最新の変更を取り込みます。
    ```bash
    # 1. 最新のdevelopブランチの情報を取得
    git fetch origin

    # 2. developブランチを自分のブランチにマージする
    git merge origin/develop
    
    # (もしコンフリクトが起きたら、下記「3. コンフリクト解消の手順」へ進む)
    ```
    *補足: `git pull origin develop` でも同様の操作が可能ですが、`fetch`と`merge`に分けることで、より何が起きているか意識しやすくなります。*

3.  **更新したブランチをプッシュする**
    - `develop`の変更を取り込んで更新した`feature`ブランチを、リモートリポジトリにプッシュします。
    ```bash
    git push origin feature/my-task
    ```

4.  **Pull Requestを作成する**
    - GitHub上で、`feature/my-task`ブランチから`develop`ブランチへのPull Requestを作成します。
    - この時点で、他の人とのコンフリクトは解消済みのはずなので、スムーズにマージできる状態になっています。

---

## 3. コンフリクト解消の具体的な手順

上記ステップ2の`git merge origin/develop`を実行した際に、ターミナルに「CONFLICT」という文字が表示された場合の対処法です。

**シナリオ：`feature/my-task`ブランチに`develop`を取り込んだらコンフリクトした！**

### ステップ1：状況を把握する (慌てない)

- まず、`git status`コマンドを実行して、どのファイルでコンフリクトが起きているかを確認します。
  ```bash
  git status
  ```
  - `Unmerged paths:`というセクションに、コンフリクトしているファイルの一覧が表示されます。

### ステップ2：コンフリクトしたファイルを開いて修正する

- エディタで該当ファイルを開くと、以下のような特殊なマーカーが追加されています。

  ```html
  <<<<<<< HEAD
  <h1>〇〇動物病院へようこそ</h1>
  =======
  <h1>ようこそ！</h1>
  >>>>>>> origin/develop
  ```

- **マーカーの見方:**
    - `<<<<<<< HEAD` から `=======` までが、**あなた自身の変更**（今いる`feature`ブランチでの変更）です。
    - `=======` から `>>>>>>> origin/develop` までが、**取り込もうとした相手の変更**（`develop`ブランチでの変更）です。

- **修正作業:**
    1.  相手の変更内容（`develop`での変更）を書いた担当者に、どのような意図の変更かを確認・相談します。
    2.  両方の変更を見比べ、最終的にどういうコードにすべきかを決めます。
    3.  **`<<<<<<<`, `=======`, `>>>>>>>` のマーカーをすべて手で削除し**、ファイルを最終的にあるべき正しい姿に編集します。
        - 例：`<h1>〇〇動物病院へようこそ！</h1>`

### ステップ3：修正したことをGitに伝える

- ファイルの修正が完了したら、`git add`コマンドで「このファイルのコンフリクトは解消しました」とGitに伝えます。
  ```bash
  # 修正したファイルを指定
  git add path/to/conflicted-file.html
  ```

### ステップ4：解消をコミットする

- すべてのコンフリクトファイルを`add`したら、マージを完了させるためのコミットを実行します。
  ```bash
  git commit
  ```
  - このコマンドを実行すると、エディタが開き、`Merge branch 'develop' into feature/my-task`のようなコミットメッセージが自動で入力されています。そのまま保存してエディタを閉じればOKです。

### ステップ5：最終的なブランチをプッシュする

- これで、あなたのローカルブランチは`develop`の変更を取り込み、かつコンフリクトも解消されたきれいな状態になりました。リモートにプッシュして、Pull Requestの作成に進みましょう。
  ```bash
  git push origin feature/my-task
  ```
